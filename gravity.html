<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gravity Flip - Big Spikes</title>
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; background: #000; color: white; 
            font-family: sans-serif; overflow: hidden; 
            display: flex; justify-content: center; align-items: center; height: 100vh; 
        }
        canvas { display: block; touch-action: none; border-top: 3px solid #00ff88; border-bottom: 3px solid #00ff88; }
        #ui { position: absolute; top: 5%; text-align: center; pointer-events: none; width: 100%; z-index: 10; }
        #score { font-size: 3.5rem; font-weight: 900; color: #00ff88; text-shadow: 0 0 20px #00ff88; }
        #overlay { 
            position: absolute; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.95); display: flex; flex-direction: column; 
            justify-content: center; align-items: center; z-index: 100;
        }
        .btn {
            padding: 15px 45px; font-size: 1.6rem; background: #00ff88; color: #000; 
            border: none; border-radius: 12px; font-weight: bold; cursor: pointer;
        }
    </style>
</head>
<body>

<div id="ui"><div id="score">0</div></div>

<div id="overlay" onclick="startGame()">
    <h1 style="color:#00ff88; font-size: 2.5rem; margin-bottom: 0;">GRAVITY FLIP</h1>
    <p style="margin-bottom: 25px;">MAI MARI, MAI GREI!</p>
    <button class="btn">START</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreUI = document.getElementById('score');
const overlay = document.getElementById('overlay');

let score = 0, gameActive = false, obstacles = [], gameSpeed = 5, scale = 1;

const player = {
    x: 50, y: 0, w: 30, h: 30,
    gravity: 0.75, // Gravitație puțin mai puternică pentru control rapid
    dy: 0,
    onCeiling: false,
    color: '#00ff88'
};

function setup() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight * 0.7; // Zona de joc mai mare
    scale = canvas.height / 400;
    player.w = 28 * scale;
    player.h = 28 * scale;
    player.x = 60 * scale;
}

window.addEventListener('resize', setup);
setup();

function startGame() {
    score = 0; scoreUI.textContent = "0";
    obstacles = []; gameSpeed = 5 * scale;
    player.y = canvas.height - player.h;
    player.dy = 0;
    player.onCeiling = false;
    gameActive = true;
    overlay.style.display = 'none';
    spawn();
    draw();
}

function spawn() {
    if(!gameActive) return;
    const isCeiling = Math.random() > 0.5;
    
    // ȚEPI MAI MARI: mărimea variază acum între 40 și 80 unități de scală
    const sizeW = (31 + Math.random() * 40) * scale;
    const sizeH = (50 + Math.random() * 60) * scale; 
    
    obstacles.push({
        x: canvas.width + 100,
        y: isCeiling ? 0 : canvas.height - sizeH,
        w: sizeW,
        h: sizeH,
        isCeiling: isCeiling
    });
    
    // Interval de apariție puțin mai strâns
    setTimeout(spawn, Math.max(500, 1400 - (score * 25)));
}

function flip() {
    if(!gameActive) return;
    player.onCeiling = !player.onCeiling;
}

window.addEventListener('touchstart', (e) => { e.preventDefault(); flip(); }, {passive: false});
window.addEventListener('mousedown', (e) => { if(e.button === 0) flip(); });

function draw() {
    if(!gameActive) return;

    ctx.fillStyle = "#000";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Fizică
    const force = player.onCeiling ? -player.gravity * scale : player.gravity * scale;
    player.dy += force;
    player.y += player.dy;

    // Limite ecran
    if(player.y <= 0) { player.y = 0; player.dy = 0; }
    if(player.y + player.h >= canvas.height) { player.y = canvas.height - player.h; player.dy = 0; }

    // Jucător (Glow)
    ctx.shadowBlur = 15; ctx.shadowColor = player.color;
    ctx.fillStyle = player.color;
    ctx.fillRect(player.x, player.y, player.w, player.h);

    // Obstacole
    ctx.shadowBlur = 0;
    for (let i = obstacles.length - 1; i >= 0; i--) {
        let o = obstacles[i];
        o.x -= gameSpeed;

        // Desenare Țep (Triunghi Neon)
        ctx.fillStyle = "#ff0055";
        ctx.shadowBlur = 10; ctx.shadowColor = "#ff0055";
        ctx.beginPath();
        if(o.isCeiling) {
            ctx.moveTo(o.x, 0);
            ctx.lineTo(o.x + o.w / 2, o.h);
            ctx.lineTo(o.x + o.w, 0);
        } else {
            ctx.moveTo(o.x, canvas.height);
            ctx.lineTo(o.x + o.w / 2, canvas.height - o.h);
            ctx.lineTo(o.x + o.w, canvas.height);
        }
        ctx.fill();

        // Coliziune îmbunătățită (hitbox puțin mai mic decât vizualul pentru corectitudine)
        const hitMargin = 5 * scale;
        if(player.x + player.w - hitMargin > o.x && player.x + hitMargin < o.x + o.w) {
            if(o.isCeiling && player.y < o.h - hitMargin) gameOver();
            if(!o.isCeiling && player.y + player.h > canvas.height - o.h + hitMargin) gameOver();
        }

        // Scor și curățare
        if(o.x < -150) {
            obstacles.splice(i, 1);
            score++;
            scoreUI.textContent = score;
            if(score % 5 === 0) gameSpeed += 0.3 * scale;
        }
    }

    requestAnimationFrame(draw);
}

function gameOver() {
    gameActive = false;
    overlay.style.display = 'flex';
    overlay.querySelector('h1').textContent = "COLLISION!";
    overlay.querySelector('p').textContent = "Scor: " + score;
}
</script>
</body>
</html>