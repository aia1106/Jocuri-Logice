<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Math Ball - Multiplication Master</title>
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            margin: 0; background: #050510; color: white; 
            font-family: 'Segoe UI', sans-serif; overflow: hidden; 
            display: flex; justify-content: center; align-items: center; height: 100vh; 
        }
        canvas { display: block; background: radial-gradient(circle, #0f0c29 0%, #302b63 50%, #24243e 100%); }
        #ui { position: absolute; top: 5%; width: 100%; text-align: center; pointer-events: none; z-index: 10; }
        #question { font-size: 3.5rem; font-weight: bold; color: #ffcc00; text-shadow: 0 0 25px rgba(255, 204, 0, 0.6); }
        #score { font-size: 1.5rem; color: #00f2ff; margin-top: 10px; }
        #overlay { 
            position: absolute; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.9); display: flex; flex-direction: column; 
            justify-content: center; align-items: center; z-index: 100;
        }
        .btn {
            padding: 15px 50px; font-size: 1.8rem; background: #ff8c00; color: white; 
            border: none; border-radius: 12px; font-weight: bold; cursor: pointer; box-shadow: 0 6px #b36200;
        }
    </style>
</head>
<body>

<div id="ui">
    <div id="question">? × ?</div>
    <div id="score">Scor: 0</div>
</div>

<div id="overlay" onclick="startGame()">
    <h1 style="color:#ff8c00; font-size: 2.5rem;">ÎNMULȚIREA NEON</h1>
    <p>Alege răspunsul portocaliu corect!</p>
    <button class="btn">START</button>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const questionUI = document.getElementById('question');
const scoreUI = document.getElementById('score');
const overlay = document.getElementById('overlay');

let score = 0, gameActive = false, platforms = [], animationId, scale = 1;
let currentAnswer = 0;

const ball = { 
    x: 0, y: 0, r: 20, 
    dy: 0, jump: -16, gravity: 0.8, 
    targetX: 0, 
    color: "#00ff88" 
};

function setup() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    scale = Math.min(canvas.width, canvas.height) / 400;
    ball.r = 20 * scale;
    ball.y = canvas.height - 100 * scale;
    ball.x = canvas.width / 2;
    ball.targetX = ball.x;
}

window.addEventListener('resize', setup);
setup();

function generateQuestion() {
    const n1 = Math.floor(Math.random() * 9) + 2; 
    const n2 = Math.floor(Math.random() * 9) + 2;
    currentAnswer = n1 * n2;
    questionUI.textContent = `${n1} × ${n2} = ?`;
    
    platforms = [];
    const positions = [canvas.width * 0.2, canvas.width * 0.5, canvas.width * 0.8];
    
    let wrong1 = currentAnswer + (Math.random() > 0.5 ? n1 : -n1);
    let wrong2 = currentAnswer + (Math.random() > 0.5 ? n2 : -n2);
    if (wrong1 <= 0 || wrong1 === currentAnswer) wrong1 = currentAnswer + 2;
    if (wrong2 <= 0 || wrong2 === currentAnswer || wrong2 === wrong1) wrong2 = currentAnswer - 2;
    
    let answers = [currentAnswer, wrong1, wrong2];
    answers.sort(() => Math.random() - 0.5);

    positions.forEach((pos, i) => {
        platforms.push({
            x: pos - 55 * scale,
            y: canvas.height - 230 * scale,
            w: 110 * scale,
            h: 22 * scale,
            val: answers[i]
        });
    });
}

function startGame() {
    score = 0; scoreUI.textContent = "Scor: 0";
    gameActive = true;
    ball.color = "#00ff88";
    overlay.style.display = 'none';
    generateQuestion();
    draw();
}

function handleTouch(e) {
    if (!gameActive || ball.dy !== 0) return;
    const touchX = (e.type === 'touchstart') ? e.touches[0].clientX : e.clientX;
    
    let selected = platforms[0];
    let minDist = Math.abs(touchX - (platforms[0].x + platforms[0].w/2));

    platforms.forEach(p => {
        let d = Math.abs(touchX - (p.x + p.w/2));
        if(d < minDist) { minDist = d; selected = p; }
    });

    ball.targetX = selected.x + selected.w/2;
    ball.dy = ball.jump * scale;
    
    setTimeout(() => {
        if(selected.val === currentAnswer) {
            score++;
            scoreUI.textContent = "Scor: " + score;
            ball.color = "#ffcc00"; 
            setTimeout(() => { if(gameActive) ball.color = "#00ff88"; }, 600);
            generateQuestion();
        } else {
            ball.color = "#ff4444"; 
            setTimeout(gameOver, 400);
        }
    }, 450);
}

window.addEventListener('mousedown', handleTouch);
window.addEventListener('touchstart', (e) => { e.preventDefault(); handleTouch(e); }, {passive: false});

function draw() {
    if(!gameActive) return;
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Platforme
    platforms.forEach(p => {
        // Stil platformă (albastru închis cu contur)
        ctx.fillStyle = "#16213e";
        ctx.strokeStyle = "#00f2ff";
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.roundRect(p.x, p.y, p.w, p.h, 8);
        ctx.fill();
        ctx.stroke();
        
        // CIFRE PORTOCALII
        ctx.fillStyle = "#ff8c00"; // Portocaliu aprins
        ctx.shadowBlur = 10;
        ctx.shadowColor = "#ff8c00";
        ctx.font = `bold ${30 * scale}px Arial`;
        ctx.textAlign = "center";
        ctx.fillText(p.val, p.x + p.w / 2, p.y + p.h + 45 * scale);
        ctx.shadowBlur = 0;
    });

    // Minge
    ball.dy += ball.gravity * scale;
    ball.y += ball.dy;
    ball.x += (ball.targetX - ball.x) * 0.15;

    if(ball.y > canvas.height - 60 * scale - ball.r) {
        ball.y = canvas.height - 60 * scale - ball.r;
        ball.dy = 0;
    }

    ctx.shadowBlur = 20;
    ctx.shadowColor = ball.color;
    ctx.fillStyle = ball.color;
    ctx.beginPath();
    ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI * 2);
    ctx.fill();

    animationId = requestAnimationFrame(draw);
}

function gameOver() {
    gameActive = false;
    overlay.style.display = 'flex';
    overlay.querySelector('h1').textContent = "FINAL DE JOC";
    overlay.querySelector('p').textContent = "Scor: " + score;
}
</script>
</body>
</html>